<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="tracking-behaviour.html">

<dom-module id="product-list-pagination">
  <template>
    <style>
      :host {
        font-family: sans-serif;
        display: flex;
        justify-content: space-around;
        align-items: center;
      }
      button {
        font-size: 16px;
      }
      #previous, #next, #description {
        display: inline-flex;
      }

    </style>

    <div id="controls">
      <button id="previous" disabled="[[previousDisabled]]" on-click="_paginatePrevious">Previous</button>
      <div id="description">Page [[pn]] of [[totalPages]]</div>
      <button id="next" disabled="[[nextDisabled]]" on-click="_paginateNext">Next</button>
    </div>

  </template>

  <script>
    Polymer({
      is: 'product-list-pagination',

      behaviors: [
          productListUtilities.productListTrackingBehavior
      ],

      properties: {
        // number of products per page
        npp: {
          type: Number,
          value: 60
        },
        // page number
        pn: {
          type: Number,
          value: 1,
          notify: true
        },
        // Total number of products in the list
        totalProducts: Number,
        // Total number of product pages
        totalPages: {
          type: Number,
          computed: '_computeTotalPages(npp, totalProducts)'
        },
        // disabled flag for previous button
        previousDisabled:{
          type: Object,
          computed: '_computePreviousButtonStatus(pn)'
        },
        // disabled flag for next button
        nextDisabled:{
          type: Object,
          computed: '_computeNextButtonStatus(pn, totalPages)'
        }
      },

      /**
       * Calculate total number of pages
       * @param {Number} npp - number of products per page
       * @param {Number} totalProducts - number of current page
       * @return {Number} totalPages - Total number of pages
       */
      _computeTotalPages: (npp, totalProducts) => {
        return Math.ceil((totalProducts / npp));
      },

      /**
       * Flag for if the next button should be disabled
       * @param {Number} pn - current page number
       * @param {Number} totalPages - Total number of pages
       * @return {Boolean} disabled - Flag for if next button should be disabled
       */
      _computeNextButtonStatus: (pn, totalPages) => {
          var disabled = true;
          if (pn < totalPages) {
            pn++;
            disabled = false;
          };
          return disabled;
      },

      /**
       * Flag for if the previous button should be disabled
       * @param {Number} pn - current page number
       * @return {Boolean} disabled - Flag for if previous button should be disabled
       */
      _computePreviousButtonStatus: (pn) => {
          var disabled = true;
          if (pn > 1) {
            pn--;
            disabled = false;
          }
          return disabled;
      },

      /**
       * Paginate to the next page
       */
      _paginateNext: function() {
        this.set('pn', this.pn + 1);
        this.fire('pagination', {
            pn: this.pn
        });
      },

      /**
       * Paginate to the previous page
       */
      _paginatePrevious: function()  {
        this.set('pn', this.pn - 1);
        this.fire('pagination', {
            pn: this.pn
        });
      }

    });
  </script>
</dom-module>
