<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="tracking-behaviour.html">

<dom-module id="product-list-pagination">
  <template>
    <style>
      :host {
        display: block;
        text-align: center
      }
    </style>
    <div id="controls">
      <button id="previous" disabled="[[previous.disabled]]" on-click="_paginatePrevious">Previous</button>
      <div id="description">Page [[pn]] of [[totalPages]]</div>
      <button id="next" disabled="[[next.disabled]]" on-click="_paginateNext">Next</button>
    </div>
  </template>

  <script>
    Polymer({
      is: 'product-list-pagination',
      behaviors: [
          productListUtilities.productListTrackingBehavior
      ],
      properties: {
        // number of products per page
        npp: {
          type: Number,
          value: 60
        },
        // page number
        pn: {
          type: Number,
          value: 1,
          notify: true
        },
        // Total number of products in the list
        totalProducts: Number,
        // Total number of product pages
        totalPages: {
          type: Number,
          computed: '_computeTotalPages(npp, totalProducts)'
        },
        previous:{
          type: Object,
          computed: '_computePagination("previous", pn)'
        },
        next:{
          type: Object,
          computed: '_computePagination("next", pn, totalPages)'
        }
      },

      _computeTotalPages: (npp, totalProducts) => {
        return Math.ceil((totalProducts / npp));
      },

      _computePagination: (direction, pn, totalPages) => {
        var disabled = true;
        // if the pagination request is for next
        if (direction === 'next') {
          if (pn < totalPages) {
            pn++;
            disabled = false;
          }
        }

        // if the pagination request is for previous
        if (direction === 'previous') {
          if (pn > 1) {
            pn--;
            disabled = false;
          }
        }

        return {
          disabled: disabled
        }

      },

      _paginateNext: function() {
        this.set('pn', this.pn + 1);
        this.fire('pagination', {
            pn: this.pn
        });
      },

      _paginatePrevious: function()  {
        this.set('pn', this.pn - 1);
        this.fire('pagination', {
            pn: this.pn
        });
      }

    });
  </script>
</dom-module>
